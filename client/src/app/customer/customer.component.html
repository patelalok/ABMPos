<mat-card>
    <mat-card-title>

        <div class="row d-flex align-items-center">
            <div class="col-md-7">
                <h4>Customer Details</h4>
            </div>

            <div class="col-md-5 d-flex align-items-center justify-content-end">
                <button type="button" class="bg-primary text-white action-button-lg m-3" (click)="this.showDialogToAdd()">
                        <i class="fa fa-plus-square" aria-hidden="true" label="Add"></i>
                            Add Customer
                    </button>

            </div>
        </div>
    </mat-card-title>
    <mat-card-content>
        <p-growl [(value)]="msgs"></p-growl>


        <div class="row">
            <div class="col-md-12">

                <p-dataTable [value]="this.customerDto" [editable]="true" scrollable="true" [responsive]="true" scrollHeight="500px">
                    <p-column field="name" header="Name" filterPlaceholder="Search For Customer Name" [filter]="true"></p-column>
                    <p-column field="phoneNo" header="PhoneNo" filterPlaceholder="Search For Customer Phono No" [sortable]="true" [filter]="true"></p-column>
                    <p-column field="email" header="Email" filterPlaceholder="Search For Customer Email" [sortable]="true" [filter]="true"></p-column>
                    <p-column field="balance" header="Balance" [sortable]="true">
                        <ng-template let-customer="rowData" pTemplate="body">
                            {{customer.balance | currency:'USD':'true'}}
                        </ng-template>
                    </p-column>
                    <p-column field="storeCredit" header="Store Credit" [sortable]="true">
                        <ng-template let-customer="rowData" pTemplate="body">
                            {{customer.storeCredit | currency:'USD':'true'}}
                        </ng-template>
                    </p-column>
                    <p-column field="loyalty" header="Loyalty" [sortable]="true">
                        <ng-template let-customer="rowData" pTemplate="body">
                            {{customer.loyalty | currency:'USD':'true'}}
                        </ng-template>
                    </p-column>
                    <p-column field="action" header="Action" [sortable]="true">

                        <ng-template let-customer="rowData" pTemplate="body">
                            <button mat-button class="btn-blue action-button-table" (click)="this.setDetailForUpdateCusotmer(customer)">
                                <i class="fa fa-pencil" aria-hidden="true"></i>
                            </button>
                            <button mat-button data-toggle="modal" data-target="#deleteCustomer" (click)="this.setCustomerForDelete(customer)" mat-button class="btn-red action-button-table" mat-button data-toggle="modal" data-target="#deleteCustomer">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                            </button>
                            <button mat-button class="btn-green action-button-table" data-toggle="modal" data-target="#productHistoryModel">
                                <i class="fa fa-history" aria-hidden="true"></i>
                            </button>
                            <button mat-button class="btn-gray action-button-table" data-toggle="modal" data-target="#addStoreCredit" (click)=this.selectCustomerForStoreCredit(customer)>
                                <i class="fa fa-credit-card-alt" aria-hidden="true"></i>                                
                                </button>
                        </ng-template>
                    </p-column>
                </p-dataTable>

            </div>
        </div>
    </mat-card-content>
</mat-card>

<form [formGroup]="customerForm">
    <p-dialog header="Add Customer Details" appendTo="body" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" [modal]="true" (onHide)="resrtForm()">

        <div class="container">

            <div class="row">

                <div class="col-md-2 p-1">
                    <label>Customer Name:</label>
                </div>

                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="name" placeholder="Enter First and Last Name">
                </div>

                <div class="col-md-2 p-1">
                    <label>Phone Number:</label>
                </div>
                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="phoneNo" placeholder="Enter Phone Number">

                </div>

                <!-- Second row of the cusotmer -->

                <div class="col-md-2 p-1">
                    <label>Company Name:</label>
                </div>

                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="companyName" placeholder="Enter Company Name">
                </div>

                <div class="col-md-2 p-1">
                    <label>Email:</label>
                </div>
                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="email" placeholder="Enter Email">

                </div>

                <!-- thirs row of customer -->

                <div class="col-md-2 p-1">
                    <label>Tax Id:</label>
                </div>

                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="taxId" placeholder="Enter Tax Id">
                </div>

                <div class="col-md-2 p-1">
                    <label>Date Of Birth:</label>
                </div>
                <div class="col-md-4 p-1">
                    <input type="text" class="form-control" formControlName="dateOfBirth" placeholder="Enter Date Of Birth">

                </div>

                <!-- forth row of customer -->
                <div class="col-md-2 p-1">
                    <label>Customer Type:</label>
                </div>

                <div class="col-md-4 p-1">
                    <select class="form-control" formControlName="type">
                                <option>Retail</option>
                                <option>Business</option>
                            </select>
                </div>

                <div class="col-md-2 p-1">
                    <label>Gender:</label>
                </div>
                <div class="col-md-4 p-1">
                    <select class="form-control" formControlName="gender">
                                <option>Male</option>
                                <option>Female</option>
                            </select>
                </div>

                <!-- Fifth row of customer -->

                <div class="col-md-2 p-1">
                    <label>Street:</label>
                </div>

                <div class="col-md-10 p-1">
                    <input type="text" class="form-control" formControlName="street" placeholder="Enter Street Details">
                </div>

                <!-- Sixth row of customer -->

                <div class="col-md-2 p-1">
                    <label>City:</label>
                </div>

                <div class="col-md-3 p-1">
                    <input type="text" class="form-control" formControlName="city">
                </div>

                <div class="col-md-1 p-1">
                    <label>State:</label>
                </div>

                <div class="col-md-2 p-1">
                    <select class="form-control" formControlName="state">
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="DC">District Of Columbia</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>

                <div class="col-md-1 p-1">
                    <label>ZipCode:</label>
                </div>
                <div class="col-md-3 p-1">
                    <input type="text" class="form-control" formControlName="zipCode" placeholder="Enter Zipcode">
                </div>

                <div class="col-md-3 p-1">
                    <div class="checkbox">
                        <label>
                                <input type="checkbox" formControlName="enableSms">
                                    Opt In For SMS
                            </label>
                    </div>
                </div>

                <div class="col-md-3 p-1">
                    <div class="checkbox">
                        <label>
                                    <input type="checkbox" formControlName="enableEmail">
                                        Opt In For Email
                                </label>
                    </div>
                </div>

            </div>
        </div>

        <p-footer>
            <div style="text-align: center">
                <button *ngIf="this.addCustomerFlag" type="button" (click)="this.addCustomer()" class="btn btn-success" [disabled]="customerForm.invalid">
                            <i class="fa fa-paper-plane" aria-hidden="true" ></i>
                            Add Customer Details
                    </button>

                <button *ngIf="!this.addCustomerFlag" type="button" (click)="this.updateCustomer()" class="btn btn-success" [disabled]="customerForm.invalid">
                            <i class="fa fa-paper-plane" aria-hidden="true" ></i>
                            Update Customer Details
                    </button>

            </div>
        </p-footer>


    </p-dialog>
</form>





<!-- Start Of Add Store Credit -->
<div class="modal fade" id="addStoreCredit" role="dialog">
    <div class="modal-dialog modal-lg">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Store Credit</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">

                <div class="row m-1">

                    <div class="col-md-12 form-group">
                        <label>Enter Store Credit Amount:</label>
                        <input [(ngModel)]="this.storeCreditAmount" class="form-control" type="number">
                    </div>
                </div>

                <div class="row m-1">
                    <div class="col-md-12 form-group">
                        <label>Enter Store Credit Reason:</label>
                        <input class="form-control" [(ngModel)]="this.storeCreditReason" type="text">
                    </div>
                </div>
                <div class="row m-2 p-2">
                    <button type="button" mat-raised-button class="bg-primary text-white action-button-lg m-auto" (click)="this.addStoreCredit()" data-dismiss="modal">
                            <i class="fa fa-plus-square" aria-hidden="true" label="Add"></i>
                        Add Store Credit
                    </button>

                    <!-- <div class="col-md-12">
                    </div> -->

                </div>

                <div class="row">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Amount</th>
                                <th>Reason</th>
                                <th>Given By</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let history of this.storeCreditDto">
                                <td>{{history.date}}</td>
                                <td>{{history.time}}</td>
                                <td>$ {{history.amount}}</td>
                                <td>{{history.reason}}</td>
                                <td>{{history.employeeName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>


            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>


    </div>

</div>
<!-- End of Add Store Credit Pop up -->

<!-- Start of Delete Customer Popup -->
<div class="modal fade" id="deleteCustomer" role="dialog">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Delete Customer</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are You Sure You Want To Delete This Customer</p>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="this.deleteCustomer()">Yes</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancle</button>
            </div>
        </div>
    </div>
</div>

<!-- End of Delete Customer Popup -->